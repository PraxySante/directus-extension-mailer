"use strict";module.exports=(e,{services:s,exceptions:n,env:t})=>{const{MailService:o}=s;e.post("/",(async(e,s,n)=>{const{body:r}=e,a=new o({schema:n});if(!(null!=t.EMAIL_ALLOW_GUEST_SEND&&t.EMAIL_ALLOW_GUEST_SEND||null!=e.accountability.user&&null!=e.accountability.role))return s.status(400).send({message:"User not authorized, enable guest sending or include a token"});if(e.body)try{const e=await a.send(r);return s.send({response:e})}catch(e){return s.send({status:e})}}))};
